// =============================================================================
// SYSTÈME DE BREAKPOINTS MODERNE - 2025 (Mis à jour 31 juillet 2025)
// =============================================================================
// Basé sur les statistiques réelles d'usage des appareils jusqu'en juillet 2025
// Mobile-first approach avec support complet iPhone 17, Android flagships, etc.

// ✅ IMPORT DES MODULES SASS MODERNES
@use 'sass:map';

// =============================================================================
// 1. BREAKPOINTS DE BASE - RESPONSIVE MOBILE-FIRST (2025)
// =============================================================================

$breakpoints: (
  // === MOBILE FIRST - SMARTPHONES ===
  'xs': 360px,
  // Samsung Galaxy S25 standard, Android budget (ajusté de 320px)
  'sm': 375px,
  // iPhone ancien (6/7/8), encore utilisé
  'android-std': 384px,
  // Samsung Galaxy S25 Ultra (nouveau 2025)
  'md': 390px,
  // iPhone 13/14 + iPhone SE 4 (février 2025)
  'lg': 393px,
  // iPhone 15/16 (standard actuel)
  'android-pixel': 412px,
  // Google Pixel série + nombreux Android
  'xl': 414px,
  // iPhone Plus (ancien mais toujours utilisé)
  'iphone-17': 410px,
  // iPhone 17 standard (septembre 2025)
  'android-plus': 455px,
  // OnePlus flagships série
  'iphone-17-air': 430px,

  // iPhone 17 Air 6.6" (nouveau format)
  // === TABLETTES PORTRAIT ===
  'tablet-sm': 744px,
  // iPad Mini 6 (format unique)
  'tablet-ipad': 768px,
  // iPad classique 9.7" (référence historique)
  'tablet-android': 800px,
  // Tablettes Android 11-12" (Samsung Tab S10, Xiaomi Pad 7)
  'tablet-md': 820px,
  // iPad Air 11" 2024
  'tablet-lg': 834px,
  // iPad Pro 11" (toutes générations)
  'tablet-android-pro': 850px,
  // OnePlus Pad 2 Pro
  'tablet-xl': 900px,
  // Grandes tablettes Android 13-14" (OnePlus Pad 3, Xiaomi Ultra)
  'tablet-ultra': 924px,
  // Samsung Galaxy Tab S10 Ultra 14.6"
  'tablet-ipad-pro': 1024px,
  // iPad Pro 12.9" (1-6e gen) + iPad Air 13"
  'tablet-ipad-13': 1032px,

  // iPad Pro 13" M4 (nouveau format Apple)
  // === TABLETTES LANDSCAPE + DESKTOP ===
  'laptop-sm': 1180px,
  // Tablettes 11" en paysage
  'laptop-md': 1194px,
  // iPad Pro 11" paysage
  'laptop-lg': 1280px,
  // Tablettes Android paysage + laptops 13"
  'laptop-xl': 1366px,
  // iPad Pro 12.9" paysage + laptops standards
  'laptop-xxl': 1376px,
  // iPad Pro 13" M4 paysage (nouveau)
  'laptop-xxxl': 1440px,

  // Laptops 15-16" + desktops 2K
  // === DESKTOP MODERNE ===
  'desktop-hd': 1920px,
  // Full HD (standard dominant)
  'desktop-2k': 2560px,
  // 2K/QHD desktops
  'desktop-4k': 3840px,
  // 4K UHD
  'desktop-ultra': 5120px // Ultrawide 5K
) !default;

// =============================================================================
// 2. BREAKPOINTS SPÉCIFIQUES PAR APPAREIL - MIS À JOUR 2025
// =============================================================================

$device-breakpoints: (
  // === IPHONE 2025 (jusqu'à juillet) ===
  'iphone-se-4': (
      width: 390px,
      height: 844px,
    ),
  // Lancé février 2025 - grand changement vs SE précédents
  'iphone-13-14': (
      width: 390px,
      height: 844px,
    ),
  // Génération dominante actuelle
  'iphone-15-16': (
      width: 393px,
      height: 852px,
    ),
  // Standard Apple actuel
  'iphone-15-16-plus': (
      width: 430px,
      height: 932px,
    ),
  // Plus grandes versions
  'iphone-13-16-pro-max': (
      width: 428px,
      height: 926px,
    ),

  // Pro Max 13-16
  // === IPHONE 17 SÉRIE (septembre 2025) ===
  'iphone-17-standard': (
      width: 410px,
      height: 890px,
    ),
  // Nouveau 6.3" (estimation)
  'iphone-17-air': (
      width: 430px,
      height: 930px,
    ),
  // Nouveau format 6.6" ultra-fin
  'iphone-17-pro': (
      width: 410px,
      height: 890px,
    ),
  // Même taille que standard
  'iphone-17-pro-max': (
      width: 440px,
      height: 950px,
    ),

  // 6.9" (estimation)
  // === ANDROID FLAGSHIPS 2025 ===
  'galaxy-s25': (
      width: 360px,
      height: 780px,
    ),
  // Samsung standard 6.2"
  'galaxy-s25-ultra': (
      width: 384px,
      height: 824px,
    ),
  // Samsung Ultra 6.8"
  'pixel-9': (
      width: 412px,
      height: 915px,
    ),
  // Google Pixel 6.3"
  'oneplus-13': (
      width: 455px,
      height: 809px,
    ),
  // OnePlus flagship 6.82"
  'xiaomi-15': (
      width: 393px,
      height: 857px,
    ),

  // Xiaomi standard
  // === IPAD 2024-2025 ===
  'ipad-mini-6': (
      width: 744px,
      height: 1133px,
    ),
  // iPad Mini moderne
  'ipad-air-11-2024': (
      width: 820px,
      height: 1180px,
    ),
  // iPad Air 11" M2
  'ipad-pro-11-m4': (
      width: 834px,
      height: 1194px,
    ),
  // iPad Pro 11" M4
  'ipad-air-13-2024': (
      width: 1024px,
      height: 1366px,
    ),
  // iPad Air 13" M2 (même que Pro 12.9")
  'ipad-pro-13-m4': (
      width: 1032px,
      height: 1376px,
    ),

  // iPad Pro 13" M4 (nouveau format)
  // === TABLETTES ANDROID 2025 ===
  'galaxy-tab-s10': (
      width: 800px,
      height: 1280px,
    ),
  // Samsung Tab S10 11"
  'galaxy-tab-s10-ultra': (
      width: 924px,
      height: 1280px,
    ),
  // Samsung Tab S10 Ultra 14.6"
  'pixel-tablet': (
      width: 800px,
      height: 1280px,
    ),
  // Google Pixel Tablet 10.95"
  'oneplus-pad-3': (
      width: 900px,
      height: 1200px,
    ),
  // OnePlus Pad 3 13"+ (2025)
  'xiaomi-pad-7': (
      width: 800px,
      height: 1280px,
    ),
  // Xiaomi Pad 7 11"
  'xiaomi-pad-7-ultra': (
      width: 900px,
      height: 1200px,
    ),

  // Xiaomi Pad 7 Ultra 14"
  // === DESKTOP STANDARDS ===
  'desktop-hd': (
      width: 1920px,
      height: 1080px,
    ),
  // Full HD dominant
  'desktop-2k': (
      width: 2560px,
      height: 1440px,
    ),
  // 2K/QHD
  'desktop-4k': (
      width: 3840px,
      height: 2160px,
    ) // 4K UHD
) !default;

// =============================================================================
// 3. FONCTIONS UTILITAIRES - AMÉLIORÉES 2025
// =============================================================================

/// Récupère une valeur de breakpoint avec validation améliorée
/// @param {String} $name - Nom du breakpoint
/// @return {String|null} - Valeur du breakpoint ou null si introuvable
@function breakpoint($name) {
  @if map.has-key($breakpoints, $name) {
    @return map.get($breakpoints, $name);
  }
  @warn "⚠️ Breakpoint `#{$name}` introuvable. Breakpoints disponibles: #{map.keys($breakpoints)}";
  @return null;
}

/// Récupère les dimensions d'un appareil avec gestion d'erreur améliorée
/// @param {String} $device - Nom de l'appareil
/// @param {String} $property - 'width' ou 'height'
/// @return {String|null} - Valeur de la dimension
@function device-dimension($device, $property: 'width') {
  @if map.has-key($device-breakpoints, $device) {
    $device-map: map.get($device-breakpoints, $device);
    @if map.has-key($device-map, $property) {
      @return map.get($device-map, $property);
    }
    @warn "⚠️ Propriété `#{$property}` introuvable pour `#{$device}`.";
    @return null;
  }
  @warn "⚠️ Appareil `#{$device}` introuvable. Appareils disponibles: #{map.keys($device-breakpoints)}";
  @return null;
}

/// Nouvelle fonction: Obtient le breakpoint suivant
/// @param {String} $name - Nom du breakpoint actuel
/// @return {String|null} - Breakpoint suivant
@function next-breakpoint($name) {
  $breakpoint-names: map.keys($breakpoints);
  $index: list.index($breakpoint-names, $name);

  @if $index and $index < length($breakpoint-names) {
    $next-name: list.nth($breakpoint-names, $index + 1);
    @return map.get($breakpoints, $next-name);
  }
  @return null;
}

// =============================================================================
// 4. MIXINS RESPONSIVE - MOBILE FIRST 2025
// =============================================================================

/// Mixin pour media query mobile-first optimisé
/// @param {String} $breakpoint - Nom du breakpoint
@mixin from($breakpoint) {
  $value: breakpoint($breakpoint);
  @if $value {
    @media (min-width: $value) {
      @content;
    }
  }
}

/// Mixin pour media query desktop-first optimisé
/// @param {String} $breakpoint - Nom du breakpoint
@mixin until($breakpoint) {
  $value: breakpoint($breakpoint);
  @if $value {
    @media (max-width: calc(#{$value} - 1px)) {
      @content;
    }
  }
}

/// Mixin pour media query entre deux breakpoints
/// @param {String} $from-breakpoint - Breakpoint minimum
/// @param {String} $until-breakpoint - Breakpoint maximum
@mixin between($from-breakpoint, $until-breakpoint) {
  $from-value: breakpoint($from-breakpoint);
  $until-value: breakpoint($until-breakpoint);

  @if $from-value and $until-value {
    @media (min-width: $from-value) and (max-width: calc(#{$until-value} - 1px)) {
      @content;
    }
  }
}

/// Mixin pour breakpoint exact (nouvelle approche 2025)
/// @param {String} $breakpoint - Nom du breakpoint
@mixin only($breakpoint) {
  $current: breakpoint($breakpoint);
  $next: next-breakpoint($breakpoint);

  @if $current and $next {
    @media (min-width: $current) and (max-width: calc(#{$next} - 1px)) {
      @content;
    }
  } @else if $current {
    @media (min-width: $current) {
      @content;
    }
  }
}

// =============================================================================
// 5. MIXINS SPÉCIFIQUES PAR APPAREIL - 2025
// =============================================================================

/// Mixin pour cibler un appareil spécifique avec orientation
/// @param {String} $device - Nom de l'appareil
/// @param {String} $orientation - 'portrait', 'landscape', ou null
@mixin device($device, $orientation: null) {
  @if map.has-key($device-breakpoints, $device) {
    $device-map: map.get($device-breakpoints, $device);
    $width: map.get($device-map, 'width');
    $height: map.get($device-map, 'height');

    @if $orientation == 'portrait' {
      @media (width: $width) and (height: $height) and (orientation: portrait) {
        @content;
      }
    } @else if $orientation == 'landscape' {
      @media (width: $height) and (height: $width) and (orientation: landscape) {
        @content;
      }
    } @else {
      @media (width: $width) and (height: $height) {
        @content;
      }
    }
  } @else {
    @warn "⚠️ Appareil `#{$device}` introuvable pour le mixin device.";
  }
}

// =============================================================================
// 6. MIXINS POUR ORIENTATIONS - AMÉLIORÉS 2025
// =============================================================================

/// Mixin pour orientation portrait
@mixin portrait {
  @media (orientation: portrait) {
    @content;
  }
}

/// Mixin pour orientation paysage
@mixin landscape {
  @media (orientation: landscape) {
    @content;
  }
}

/// Mixin pour écrans hauts (nouveaux smartphones 2025)
@mixin tall-screen {
  @media (min-height: 850px) {
    @content;
  }
}

/// Mixin pour écrans courts
@mixin short-screen {
  @media (max-height: 700px) {
    @content;
  }
}

/// Nouveau: Mixin pour écrans ultra-larges (iPhone 17 Air, grandes tablettes)
@mixin ultra-wide {
  @media (min-width: 900px) {
    @content;
  }
}

// =============================================================================
// 7. MIXINS POUR DENSITÉ D'ÉCRAN - 2025
// =============================================================================

/// Mixin pour écrans haute densité (Retina, 3x, etc.)
@mixin high-density {
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    @content;
  }
}

/// Mixin pour écrans très haute densité (iPhone Pro, flagships Android)
@mixin ultra-density {
  @media (-webkit-min-device-pixel-ratio: 3), (min-resolution: 288dpi) {
    @content;
  }
}

/// Mixin pour écrans basse densité
@mixin low-density {
  @media (-webkit-max-device-pixel-ratio: 1.5), (max-resolution: 144dpi) {
    @content;
  }
}

// =============================================================================
// 8. MIXINS POUR PRÉFÉRENCES UTILISATEUR - 2025
// =============================================================================

/// Mixin pour mode sombre (très populaire en 2025)
@mixin dark-mode {
  @media (prefers-color-scheme: dark) {
    @content;
  }
}

/// Mixin pour mode clair
@mixin light-mode {
  @media (prefers-color-scheme: light) {
    @content;
  }
}

/// Mixin pour réduction de mouvement (accessibilité)
@mixin reduced-motion {
  @media (prefers-reduced-motion: reduce) {
    @content;
  }
}

/// Mixin pour mouvement normal
@mixin motion-ok {
  @media (prefers-reduced-motion: no-preference) {
    @content;
  }
}

/// Nouveau 2025: Mixin pour contraste élevé
@mixin high-contrast {
  @media (prefers-contrast: high) {
    @content;
  }
}

/// Nouveau 2025: Mixin pour données réduites
@mixin reduced-data {
  @media (prefers-reduced-data: reduce) {
    @content;
  }
}

// =============================================================================
// 9. MIXINS COMBINÉS AVANCÉS - 2025
// =============================================================================

/// Smartphones 2025 en portrait (mis à jour avec nouveaux modèles)
@mixin mobile-portrait {
  @media (max-width: 479px) and (orientation: portrait) {
    @content;
  }
}

/// Smartphones 2025 en paysage
@mixin mobile-landscape {
  @media (max-width: 926px) and (orientation: landscape) {
    @content;
  }
}

/// Tablettes 2025 en portrait (Android + iPad)
@mixin tablet-portrait {
  @media (min-width: 744px) and (max-width: 1032px) and (orientation: portrait) {
    @content;
  }
}

/// Tablettes 2025 en paysage
@mixin tablet-landscape {
  @media (min-width: 1024px) and (max-width: 1376px) and (orientation: landscape) {
    @content;
  }
}

/// Desktop et plus (mis à jour 2025)
@mixin desktop-up {
  @media (min-width: 1377px) {
    @content;
  }
}

/// Nouveau: Mixin pour appareils Apple spécifiquement
@mixin apple-devices {
  @media (-webkit-min-device-pixel-ratio: 2) {
    @content;
  }
}

/// Nouveau: Mixin pour flagships Android 2025
@mixin android-flagships {
  @media (min-width: 360px) and (max-width: 455px) {
    @content;
  }
}

// =============================================================================
// 10. MIXINS POUR CONTENEURS - AMÉLIORÉS 2025
// =============================================================================

/// Conteneur responsive avec nouvelles largeurs maximales 2025
@mixin container($max-width: null) {
  width: 100%;
  padding-inline: clamp(1rem, 5vw, 2rem);
  margin-inline: auto;

  @if $max-width {
    max-width: $max-width;
  } @else {
    @include from('tablet-sm') {
      max-width: 744px;
    }

    @include from('tablet-ipad') {
      max-width: 768px;
    }

    @include from('tablet-android') {
      max-width: 800px;
    }

    @include from('tablet-ipad-pro') {
      max-width: 1024px;
    }

    @include from('laptop-md') {
      max-width: 1200px;
    }

    @include from('desktop-hd') {
      max-width: 1400px;
    }
  }
}

/// Nouveau: Conteneur pour grandes tablettes 2025
@mixin container-xl {
  @include container;

  @include from('tablet-xl') {
    max-width: 1600px;
  }
}

// =============================================================================
// 11. HELPERS RAPIDES - NOUVEAUTÉS 2025
// =============================================================================

/// Helper: Cacher sur mobile uniquement
@mixin hide-mobile {
  @include until('tablet-sm') {
    display: none !important;
  }
}

/// Helper: Afficher sur mobile uniquement
@mixin show-mobile-only {
  @include from('tablet-sm') {
    display: none !important;
  }
}

/// Helper: Optimisations pour iPhone 17 série
@mixin iphone-17-optimizations {
  @include device('iphone-17-air') {
    /* Optimisations pour l'iPhone 17 Air ultra-fin */
    @content;
  }
}

/// Helper: Support tablettes ultra-larges 2025
@mixin ultra-tablets {
  @media (min-width: 900px) and (max-width: 1376px) {
    @content;
  }
}

// =============================================================================
// 12. EXEMPLES D'UTILISATION - PATTERNS 2025
// =============================================================================

/*
// Utilisation mobile-first moderne avec nouveaux breakpoints
.component {
  padding: 1rem;
  
  @include from('md') {
    padding: 1.5rem; // iPhone 13/14 + SE 4
  }
  
  @include from('lg') {
    padding: 2rem; // iPhone 15/16
  }
  
  @include from('android-pixel') {
    padding: 2.5rem; // Google Pixel + Android standards
  }
}

// Ciblage spécifique iPhone 17 Air (nouveau format 2025)
.hero-section {
  height: 60vh;
  
  @include device('iphone-17-air', 'portrait') {
    height: 70vh; // Plus de hauteur pour le format ultra-fin
  }
}

// Support tablettes Android modernes + iPad
.grid {
  display: grid;
  grid-template-columns: 1fr;
  
  @include from('tablet-android') {
    grid-template-columns: repeat(2, 1fr); // Tablettes Android 11-12"
  }
  
  @include from('tablet-xl') {
    grid-template-columns: repeat(3, 1fr); // Grandes tablettes 13-14"
  }
  
  @include from('tablet-ipad-pro') {
    grid-template-columns: repeat(4, 1fr); // iPad Pro 12.9"
  }
}

// Optimisations pour préférences utilisateur 2025
.card {
  background: white;
  transition: transform 0.3s ease;
  
  @include dark-mode {
    background: #1a1a1a;
  }
  
  @include motion-ok {
    &:hover {
      transform: translateY(-4px);
    }
  }
  
  @include reduced-motion {
    transition: none;
  }
  
  @include high-contrast {
    border: 2px solid currentColor;
  }
}

// Support Samsung Galaxy S25 Ultra (nouveau 2025)
.notification {
  @include device('galaxy-s25-ultra') {
    top: 2rem; // Ajustement pour la barre de statut
  }
}

// Navigation adaptée aux nouveaux formats
.navigation {
  @include mobile-portrait {
    position: fixed;
    bottom: 0;
  }
  
  @include android-flagships {
    padding: 0.75rem 1rem; // Optimisé pour flagships Android
  }
  
  @include ultra-tablets {
    grid-template-columns: repeat(6, 1fr); // Plus d'espace sur grandes tablettes
  }
}
*/

// =============================================================================
// 13. CHANGELOG & MIGRATION
// =============================================================================

/*
CHANGELOG 2025:

AJOUTS MAJEURS:
✅ Support iPhone SE 4 (février 2025) - 390px
✅ Support iPhone 17 série (septembre 2025) - nouveaux formats
✅ Breakpoints Android flagships 2025 (Galaxy S25, Pixel 9, OnePlus 13)
✅ Tablettes Android modernes (Tab S10, OnePlus Pad 3, Xiaomi Pad 7)
✅ iPad Pro 13" M4 (nouveau format Apple)
✅ Breakpoints 800px, 900px pour tablettes Android
✅ Helpers pour préférences utilisateur modernes
✅ Support ultra-wide et ultra-tablets

MIGRATION depuis ancien système:
- 'xs': 320px → 360px (Samsung Galaxy standards)
- Ajouter: 384px, 390px, 393px, 412px (mobiles 2025)
- Ajouter: 800px, 900px, 924px (tablettes Android)
- Ajouter: 1032px (iPad Pro 13" M4)
- Utiliser les nouveaux helpers et device mixins

DEPRECATED (à migrer progressivement):
- Anciens mixins @mixin small, @mixin mobile (remplacés par system moderne)
- Breakpoints device-specific trop anciens (iPhone 6, etc.)
*/
